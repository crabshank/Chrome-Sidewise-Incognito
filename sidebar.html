<html>
<head>
    <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title i18n="sidebarTitle"></title>

    <link type="text/css" rel="stylesheet" href="/css/reset.css"/>
    <link type="text/css" rel="stylesheet" href="/css/common.css"/>
    <link type="text/css" rel="stylesheet" href="/css/sidebars.css"/>
    <link rel='shortcut icon' href="images/light-bulb-sideways4_16x16.png" type="image/x-icon" />

    <script type="text/javascript" src="/js/jquery/jquery-1.7.2.min.js"></script>
    <script type="text/javascript" src="/js/jquery/jquery.tools.min.js"></script>
    <script type='text/javascript' src='/js/jquery/jquery.scrollTo-min.js'></script>

    <script type="text/javascript" src="/js/lib/util/i18n.js"></script>

    <script type="text/javascript" src="/js/lib/ui/classes/SidebarNavManager.js"></script>

    <script>
    var sidebars = {
        'pages': ['sidebars/pages.html', 'Pages', 'images/nav/pages.png'],
        'reddit': ['sidebars/external-site.html#http://i.reddit.com', 'Reddit', 'images/nav/reddit.png'],
        'tribunal': ['sidebars/external-site.html#https://tribunal.herokuapp.com/', 'Tribunal', 'images/nav/tribunal.png'],
        'twitter': ['sidebars/external-site.html#http://mobile.twitter.com', 'Twitter', 'http://twitter.com/favicon.ico'],
        'p404': ['sidebars/404.html', '404&nbsp;test', 'images/nav/pages.png']
    };

    var initialSidebar = 'pages';

    var manager;

    $(document).ready(function() {

        manager = new SidebarNavManager(sidebars,
            $('ul#sidebarButtons'), $('tr#sidebars'), $('table#main'), $('body'), 'td');
        manager.createSidebarButtons();
        manager.createSidebarContainers();
        setTimeout(function() { $.scrollTo(0); }, 0);
        setTimeout(function() { $.scrollTo(0); }, 50);
        setTimeout(function() { manager.showSidebar(initialSidebar); }, 100);

        // TODO pass keydown events to child iframe
        // $(document).keydown(function(evt) {
        //     var iframe = $( $('#pages').children('iframe').get(0).contentWindow.document );
        //     iframe.trigger('keydown');
        //     return false;
        // });
        $(document).keydown({manager: manager}, function(evt) {
            if (evt.keyCode == 70 && evt.ctrlKey) {
                var iframe = $(
                    $('#' + evt.data.manager.currentSidebar ).children('iframe').get(0).contentWindow.document
                    );
                var filterBox = iframe.find('#pageFilter');
                if (filterBox.length == 0) {
                    filterBox.focus();
                }
                evt.stopPropagation();
                return false;
            }
            return true;
        });

        $('div#headerRight > a').tooltip({ position: 'bottom center', predelay: 400, offset: [15, -10]});

        setI18NText();
    });
</script>

</head>

<body>

    <table id="main">
        <tr>
            <td id="header">
                <div id="headerBox">
                    <ul id="sidebarButtons"/>
                    <div id="headerRight">
                        <a href="#" title="Options"><img src="/images/settings_solid.png"/></a>
                    </div>
                </div>
            </td>
        </tr>
        <tr id="sidebars"/>
    </table>

</body>
</html>